<mat-form-field>
  <mat-label>Filter</mat-label>
  <input matInput (keyup)="applyFilter($event)" placeholder="Ex. Mia" #input />
</mat-form-field>

<div class="mat-elevation-z8">
  <table mat-table [dataSource]="dataSource" matSort>
    <!-- ID Column -->
    <ng-container matColumnDef="id">
      <th style="width: 70px" mat-header-cell *matHeaderCellDef mat-sort-header>
        ID
      </th>
      <td style="width: 70px" mat-cell *matCellDef="let row">{{ row.id }}</td>
    </ng-container>

    <!-- ID Column -->
    <ng-container matColumnDef="official_code">
      <th style="width: 70px" mat-header-cell *matHeaderCellDef>Official code</th>
      <td style="width: 70px" mat-cell *matCellDef="let row">{{ row.official_code }}</td>
    </ng-container>

    <!-- Name Column -->
    <ng-container matColumnDef="name">
      <th style="min-width: 500px; text-align: left;" mat-header-cell *matHeaderCellDef>Name</th>
      <td style="min-width: 500px; text-align: left;" mat-cell *matCellDef="let row">{{ row.name }}</td>
    </ng-container>

    <!-- Short Column -->
    <ng-container matColumnDef="short_name">
      <th style="text-align: left;" mat-header-cell *matHeaderCellDef>Short Name</th>
      <td style="text-align: left;" mat-cell *matCellDef="let row">{{ row.short_name }}</td>
    </ng-container>
    <!-- my_role Column -->
    <ng-container matColumnDef="my_role">
      <th mat-header-cell *matHeaderCellDef>My role</th>
      <td mat-cell *matCellDef="let row">{{ myRoles(row.roles) }}</td>
    </ng-container>

    <!-- last update at Column -->
    <ng-container matColumnDef="last_update_at">
      <th style="width: 130px" mat-header-cell *matHeaderCellDef>Last update at</th>
      <td style="width: 130px" mat-cell *matCellDef="let row">{{ row.last_update_at | date }}</td>
    </ng-container>

    <!-- status Column -->
    <ng-container matColumnDef="status">
      <th style="width: 130px" mat-header-cell *matHeaderCellDef>Status</th>
      <td style="width: 130px" mat-cell *matCellDef="let row">
        {{  row.last_submitted_at !=null && row.last_update_at == row.last_submitted_at ? row?.latest_submission ? row?.latest_submission?.status : "Draft"  : "Draft" }}
      </td>
    </ng-container>

    <!-- actions -->
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Actions</th>
      <td
        class="actions"
        style="min-width: 270px"
        mat-cell
        *matCellDef="let row"
      >
        <button
          matTooltip="Manage Initiative Team"
          matTooltipPosition="above"
          *ngIf="isLeader(row.roles)"
          routerLink="initiative/{{ row['id'] }}/{{
            row['official_code']
          }}/team-members"
          mat-icon-button
        >
          <mat-icon>group</mat-icon>
        </button>
        <button
          matTooltip="Manage Initiative activites"
          matTooltipPosition="above"
          *ngIf="isLeader(row.roles)"
          routerLink="initiative/{{ row['id'] }}/{{
            row['official_code']
          }}/submission"
          mat-icon-button
        >
          <mat-icon>playlist_add</mat-icon>
        </button>
        <button
          matTooltip="Submit your center activites"
          matTooltipPosition="above"
          *ngIf="isCoordinaror(row.roles)"
          routerLink="initiative/{{ row['id'] }}/{{
            row['official_code']
          }}/submission"
          mat-icon-button
        >
          <mat-icon>playlist_add_check</mat-icon>
        </button>
        <button
          matTooltip="View Submited versions"
          matTooltipPosition="above"
          routerLink="initiative/{{ row['id'] }}/{{
            row['official_code']
          }}/submited-versions"
          mat-icon-button
        >
          <mat-icon>view_carousel</mat-icon>
        </button>
        <button
          mat-icon-button
          (click)="openDialog(row.id)"
          matTooltip="Assign Organizations"
          matTooltipPosition="above"
        >
          <mat-icon>dns</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

    <!-- Row shown when there is no matching data. -->
    <tr class="mat-row" *matNoDataRow>
      <td class="mat-cell" colspan="4">
        No data matching the filter "{{ input.value }}"
      </td>
    </tr>
  </table>

  <mat-paginator
    [pageSizeOptions]="[10, 20, 30, 50, 100]"
    aria-label="Select page of users"
  ></mat-paginator>
</div>
